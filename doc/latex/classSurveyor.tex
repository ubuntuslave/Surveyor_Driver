\hypertarget{classSurveyor}{
\section{Surveyor Class Reference}
\label{classSurveyor}\index{Surveyor@{Surveyor}}
}
Plugin Driver for \hyperlink{classSurveyor}{Surveyor} SRV-1 (with ARM-7 processor).  


{\tt \#include $<$src/surveyor\_\-driver.h$>$}

\subsection*{Public Member Functions}
\begin{CompactItemize}
\item 
\hyperlink{classSurveyor_b0792137ec4760d15de63856ebeb7464}{Surveyor} (ConfigFile $\ast$cf, int section)
\begin{CompactList}\small\item\em Constructor for the \hyperlink{classSurveyor}{Surveyor} multi-interface driver. \item\end{CompactList}\item 
int \hyperlink{classSurveyor_c127d6028c08790fe79902b1b8359468}{Setup} ()
\begin{CompactList}\small\item\em Set up the device and start the device thread by calling StartThread(), which spawns a new thread and executes \hyperlink{classSurveyor_e6ae9ea8d60a2038b6dacdab7ccee458}{Surveyor::Main()}, which contains the main loop for the driver. \item\end{CompactList}\item 
int \hyperlink{classSurveyor_cfe0180d05f0a34474a75cdfd87b1a81}{Shutdown} ()
\begin{CompactList}\small\item\em Shut down the device. \item\end{CompactList}\item 
int \hyperlink{classSurveyor_9af107b9b363d15951303c3cbaf4328f}{ProcessMessage} (QueuePointer \&resp\_\-queue, player\_\-msghdr $\ast$hdr, void $\ast$data)
\begin{CompactList}\small\item\em Message handler that sends a response if necessary using Publish(). This function is called once for each message in the incoming queue. \item\end{CompactList}\end{CompactItemize}
\subsection*{Private Member Functions}
\begin{CompactItemize}
\item 
\hypertarget{classSurveyor_e6ae9ea8d60a2038b6dacdab7ccee458}{
virtual void \hyperlink{classSurveyor_e6ae9ea8d60a2038b6dacdab7ccee458}{Main} ()}
\label{classSurveyor_e6ae9ea8d60a2038b6dacdab7ccee458}

\begin{CompactList}\small\item\em Main \char`\"{}entry point\char`\"{} function for the driver thread created using StartThread() within the \hyperlink{classSurveyor_c127d6028c08790fe79902b1b8359468}{Setup()} function;. \item\end{CompactList}\end{CompactItemize}
\subsection*{Private Attributes}
\begin{CompactItemize}
\item 
\hypertarget{classSurveyor_38749a6bd74747baebfe451c31a421a2}{
const char $\ast$ \hyperlink{classSurveyor_38749a6bd74747baebfe451c31a421a2}{portname}}
\label{classSurveyor_38749a6bd74747baebfe451c31a421a2}

\begin{CompactList}\small\item\em Serial port. \item\end{CompactList}\item 
\hypertarget{classSurveyor_0461b15e1ccc6ad41ba2b35c5c0a9fd9}{
player\_\-devaddr\_\-t \hyperlink{classSurveyor_0461b15e1ccc6ad41ba2b35c5c0a9fd9}{position\_\-addr}}
\label{classSurveyor_0461b15e1ccc6ad41ba2b35c5c0a9fd9}

\begin{CompactList}\small\item\em Address of the position device (wheels odometry). \item\end{CompactList}\item 
\hypertarget{classSurveyor_918eb3eda100f7d55a60f2a747f0c8ab}{
player\_\-devaddr\_\-t \hyperlink{classSurveyor_918eb3eda100f7d55a60f2a747f0c8ab}{camera\_\-addr}}
\label{classSurveyor_918eb3eda100f7d55a60f2a747f0c8ab}

\begin{CompactList}\small\item\em Address of the camera device. \item\end{CompactList}\item 
\hypertarget{classSurveyor_1bfadaaaab919f00e8cd57ee287cfac8}{
player\_\-devaddr\_\-t \hyperlink{classSurveyor_1bfadaaaab919f00e8cd57ee287cfac8}{ir\_\-addr}}
\label{classSurveyor_1bfadaaaab919f00e8cd57ee287cfac8}

\begin{CompactList}\small\item\em Address of the infrared (IR) beacons. \item\end{CompactList}\item 
\hypertarget{classSurveyor_176ae803c97cadfc05b2cf88187b4ed2}{
player\_\-devaddr\_\-t \hyperlink{classSurveyor_176ae803c97cadfc05b2cf88187b4ed2}{dio\_\-addr}}
\label{classSurveyor_176ae803c97cadfc05b2cf88187b4ed2}

\begin{CompactList}\small\item\em Address of the digital input/output pins (ports). \item\end{CompactList}\item 
\hypertarget{classSurveyor_2944f9704a7846b9607c5fc330f51a0a}{
srv1\_\-comm\_\-t $\ast$ \hyperlink{classSurveyor_2944f9704a7846b9607c5fc330f51a0a}{srvdev}}
\label{classSurveyor_2944f9704a7846b9607c5fc330f51a0a}

\begin{CompactList}\small\item\em The surveyor object. \item\end{CompactList}\item 
\hypertarget{classSurveyor_1633824b8c32a4dc48aecafb5f775956}{
player\_\-position2d\_\-cmd\_\-vel\_\-t \hyperlink{classSurveyor_1633824b8c32a4dc48aecafb5f775956}{position\_\-cmd}}
\label{classSurveyor_1633824b8c32a4dc48aecafb5f775956}

\begin{CompactList}\small\item\em position2d velocity command \item\end{CompactList}\item 
\hypertarget{classSurveyor_d59f0d50a970033851d0c6e6e72d48b7}{
player\_\-position2d\_\-geom\_\-t \hyperlink{classSurveyor_d59f0d50a970033851d0c6e6e72d48b7}{pos\_\-geom}}
\label{classSurveyor_d59f0d50a970033851d0c6e6e72d48b7}

\begin{CompactList}\small\item\em position2d geometry \item\end{CompactList}\item 
\hypertarget{classSurveyor_a9a8bda99bee792ea04267b650a4e161}{
int \hyperlink{classSurveyor_a9a8bda99bee792ea04267b650a4e161}{setup\_\-image\_\-mode}}
\label{classSurveyor_a9a8bda99bee792ea04267b650a4e161}

\begin{CompactList}\small\item\em Desired camera size. \item\end{CompactList}\end{CompactItemize}


\subsection{Detailed Description}
Plugin Driver for \hyperlink{classSurveyor}{Surveyor} SRV-1 (with ARM-7 processor). 

These robots can be controlled via ZigBee which is attached to a USB serial port on a host computer. The host computer runs the server which then communicates to the robot.

\begin{Desc}
\item[Note:]The newer SRV-1 robot (with Blackfin processor) has not yet been tested with this driver.\end{Desc}
\begin{Desc}
\item[Compile-time dependencies]\end{Desc}
\begin{itemize}
\item none\end{itemize}


\begin{Desc}
\item[Provides]\end{Desc}
The surveyor driver provides the following device interfaces:

\begin{itemize}
\item interface\_\-position2d\begin{itemize}
\item This interface does not return odometry data, but accepts velocity commands.\end{itemize}
\end{itemize}


\begin{itemize}
\item interface\_\-camera\begin{itemize}
\item The camera on the robot returns JPEG images.\end{itemize}
\end{itemize}


\begin{itemize}
\item interface\_\-ir\begin{itemize}
\item The robot has 4 IR beacons which can act as rudimentary range-finders\begin{itemize}
\item UNIMPLEMENTED\end{itemize}
\end{itemize}
\end{itemize}


\begin{itemize}
\item interface\_\-dio\begin{itemize}
\item The robot has 5 pins which can be used as digital in/out ports.\begin{itemize}
\item UNIMPLEMENTED\end{itemize}
\end{itemize}
\end{itemize}


\begin{Desc}
\item[Supported configuration requests]\end{Desc}
\begin{itemize}
\item none\end{itemize}


\begin{Desc}
\item[Configuration file options]\end{Desc}
\begin{itemize}
\item port (string)\begin{itemize}
\item Serial port used to communicate with the robot\begin{itemize}
\item Default: \char`\"{}/dev/ttyUSB0\char`\"{}\end{itemize}
\end{itemize}
\item image\_\-size (string)\begin{itemize}
\item Size of the images returned by the camera.\begin{itemize}
\item Default: \char`\"{}320x240\char`\"{}\item Allowed values: \char`\"{}320x240\char`\"{}, \char`\"{}160x128\char`\"{}, \char`\"{}80x64\char`\"{}\end{itemize}
\end{itemize}
\item plugin (string)\begin{itemize}
\item Relative or Absolute path to the location of the shared-object plugin driver.\end{itemize}
\end{itemize}


\begin{Desc}
\item[Example]\end{Desc}


\footnotesize\begin{verbatim}
 driver
 (
   name "surveyor"
   plugin "libSurveyor_Driver.so"
   provides ["position2d:0" "camera:0"]
   port "/dev/ttyUSB0"
 )
 \end{verbatim}
\normalsize


\begin{Desc}
\item[\hyperlink{bug__bug000001}{Bug}]\begin{itemize}
\item Camera interface appears delayed for an arbitrary sequence of snapshots\item Camera rate is very slow - about 1fps...Could do better: at least 4fps\end{itemize}
\end{Desc}
\begin{Desc}
\item[\hyperlink{todo__todo000001}{Todo}]\begin{itemize}
\item Property bags to change image size on the fly\item Implement IR (IR sensors are very noisy and produce false negatives on dark and shiny obstacles)\item Implement DIO\item Opaque interface to set program\end{itemize}
\end{Desc}
\begin{Desc}
\item[Author:]Michael Janssen (original author) 

Carlos Jaramillo (current maintainer) \end{Desc}


Definition at line 118 of file surveyor\_\-driver.h.

\subsection{Constructor \& Destructor Documentation}
\hypertarget{classSurveyor_b0792137ec4760d15de63856ebeb7464}{
\index{Surveyor@{Surveyor}!Surveyor@{Surveyor}}
\index{Surveyor@{Surveyor}!Surveyor@{Surveyor}}
\subsubsection[{Surveyor}]{\setlength{\rightskip}{0pt plus 5cm}Surveyor::Surveyor (ConfigFile $\ast$ {\em cf}, \/  int {\em section})}}
\label{classSurveyor_b0792137ec4760d15de63856ebeb7464}


Constructor for the \hyperlink{classSurveyor}{Surveyor} multi-interface driver. 

Constructor for the \hyperlink{classSurveyor}{Surveyor} driver. Retrieves options from the configuration file, allocates memory for each interface and then reads and adds the interfaces provided in the configuration file.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em cf}]Current configuration file \item[{\em section}]Current section in configuration file \end{description}
\end{Desc}


Definition at line 42 of file surveyor\_\-driver.cc.

References camera\_\-addr, dio\_\-addr, ir\_\-addr, portname, position\_\-addr, setup\_\-image\_\-mode, and srvdev.

\subsection{Member Function Documentation}
\hypertarget{classSurveyor_9af107b9b363d15951303c3cbaf4328f}{
\index{Surveyor@{Surveyor}!ProcessMessage@{ProcessMessage}}
\index{ProcessMessage@{ProcessMessage}!Surveyor@{Surveyor}}
\subsubsection[{ProcessMessage}]{\setlength{\rightskip}{0pt plus 5cm}int Surveyor::ProcessMessage (QueuePointer \& {\em resp\_\-queue}, \/  player\_\-msghdr $\ast$ {\em hdr}, \/  void $\ast$ {\em data})}}
\label{classSurveyor_9af107b9b363d15951303c3cbaf4328f}


Message handler that sends a response if necessary using Publish(). This function is called once for each message in the incoming queue. 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em resp\_\-queue}]The queue to which any response should go \item[{\em hdr}]The message header \item[{\em data}]The message body \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]0 if the message in handled, and -1 otherwise. A NACK (Negative Acknowledgment) will be sent if a response is required. \end{Desc}


Definition at line 227 of file surveyor\_\-driver.cc.

References pos\_\-geom, position\_\-addr, position\_\-cmd, and srvdev.\hypertarget{classSurveyor_c127d6028c08790fe79902b1b8359468}{
\index{Surveyor@{Surveyor}!Setup@{Setup}}
\index{Setup@{Setup}!Surveyor@{Surveyor}}
\subsubsection[{Setup}]{\setlength{\rightskip}{0pt plus 5cm}int Surveyor::Setup ()}}
\label{classSurveyor_c127d6028c08790fe79902b1b8359468}


Set up the device and start the device thread by calling StartThread(), which spawns a new thread and executes \hyperlink{classSurveyor_e6ae9ea8d60a2038b6dacdab7ccee458}{Surveyor::Main()}, which contains the main loop for the driver. 

\begin{Desc}
\item[Returns:]0 if things go well, and -1 otherwise. \end{Desc}


Definition at line 100 of file surveyor\_\-driver.cc.

References portname, setup\_\-image\_\-mode, and srvdev.\hypertarget{classSurveyor_cfe0180d05f0a34474a75cdfd87b1a81}{
\index{Surveyor@{Surveyor}!Shutdown@{Shutdown}}
\index{Shutdown@{Shutdown}!Surveyor@{Surveyor}}
\subsubsection[{Shutdown}]{\setlength{\rightskip}{0pt plus 5cm}int Surveyor::Shutdown ()}}
\label{classSurveyor_cfe0180d05f0a34474a75cdfd87b1a81}


Shut down the device. 

\begin{Desc}
\item[Returns:]0 when the device has been completely shut down. \end{Desc}


Definition at line 125 of file surveyor\_\-driver.cc.

References srvdev.

The documentation for this class was generated from the following files:\begin{CompactItemize}
\item 
src/surveyor\_\-driver.h\item 
src/surveyor\_\-driver.cc\end{CompactItemize}
